(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{343:function(e,n,s){"use strict";s.r(n);var t=s(33),r=Object(t.a)({},(function(){var e=this,n=e.$createElement,s=e._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"vue四-node后端响应登录请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue四-node后端响应登录请求"}},[e._v("#")]),e._v(" [Vue四]:node后端响应登录请求")]),e._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#_1-须知知识点"}},[e._v("1.须知知识点")])]),s("li",[s("a",{attrs:{href:"#_2-在项目中安装依赖框架"}},[e._v("2.在项目中安装依赖框架")])]),s("li",[s("a",{attrs:{href:"#_3-编写api对前端请求给与反应"}},[e._v("3.编写api对前端请求给与反应")])]),s("li",[s("a",{attrs:{href:"#_4-开启api服务"}},[e._v("4.开启api服务")])])])]),s("p"),e._v(" "),s("h2",{attrs:{id:"_1-须知知识点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-须知知识点"}},[e._v("#")]),e._v(" 1.须知知识点")]),e._v(" "),s("p",[e._v("1."),s("a",{attrs:{href:"http://nodejs.cn/api/",target:"_blank",rel:"noopener noreferrer"}},[e._v("node.js"),s("OutboundLink")],1),e._v("编程\n2."),s("a",{attrs:{href:"http://www.expressjs.com.cn/starter/installing.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("express"),s("OutboundLink")],1),e._v("框架\n3."),s("a",{attrs:{href:"https://www.npmjs.com/package/body-parser",target:"_blank",rel:"noopener noreferrer"}},[e._v("body-parser"),s("OutboundLink")],1),e._v("中间件，解析post请求\n"),s("strong",[e._v("4.隐藏知识点：前端Vue及相应框架实现对对后端的访问请求\n[Vue二]、[vue三]")])]),e._v(" "),s("h2",{attrs:{id:"_2-在项目中安装依赖框架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-在项目中安装依赖框架"}},[e._v("#")]),e._v(" 2.在项目中安装依赖框架")]),e._v(" "),s("p",[e._v("1.项目所需框架都是在node服务项目文件夹下通过npm进行安装和添加依赖(-S 代表当前环境安装，非全局安装)\n生成默认的package.json文件")]),e._v(" "),s("blockquote",[s("p",[e._v("npm init -y")])]),e._v(" "),s("p",[e._v("package.json默认内容为：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('{\n  "name": "nodestydy",\n  "version": "1.0.0",\n  "description": "",\n  "main": "index.js",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC",\n  "dependencies": {\n  }\n}\n')])])]),s("p",[e._v("安装express")]),e._v(" "),s("blockquote",[s("p",[e._v("npm install express -S")])]),e._v(" "),s("p",[e._v("安装body-parser")]),e._v(" "),s("blockquote",[s("p",[e._v("npm install body-parser –S")])]),e._v(" "),s("p",[e._v("查看package.json文件可以看到npm自动将所有安装的框架添加了依赖:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('{\n  "name": "nodestydy",\n  "version": "1.0.0",\n  "description": "",\n  "main": "index.js",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1"\n  },\n  "keywords": [],\n  "author": "",\n  "license": "ISC",\n  "dependencies": {\n  \t"body-parser": "^1.19.0",\n    "express": "^4.17.1",\n  }\n}\n')])])]),s("h2",{attrs:{id:"_3-编写api对前端请求给与反应"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-编写api对前端请求给与反应"}},[e._v("#")]),e._v(" 3.编写api对前端请求给与反应")]),e._v(" "),s("p",[e._v("1.在工作目录下新建app.js文件，实现接受请求并返回数据：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("//导入模块\nconst express = require('express');\nconst app = express();\nconst bodyParser = require('body-parser');\nconst fs = require('fs')\napp.use(bodyParser.urlencoded({extended: true}));\n//生成token的所需的md5加密\nconst md5 = require('md5');\n\n//请求用户的token\nlet token = \"\"\n\n//对于登陆的post求情做出回应\nvar count = 0;\n//中间件对访问次数进行统计\napp.post('/loginapp',(req,res,next)=>{\n    count ++;\n    console.log(count);\n    next();\n});\napp.post('/loginapp',(req,res)=>{\n    let user = req.body;\n    console.log(user)\n    if(user.usename == 'admin' && user.password == 123456){\n        token = md5(user.usename+user.password)\n        res.send({'msg':'S','token':md5(user.usename+user.password)});\n    }else{\n        res.send({'msg':'F'})\n    }\n});\n\napp.get('/loginapp',(req,res,next)=>{\n    count ++;\n    console.log(count);\n    next();\n});\napp.get('/loginapp',(req,res)=>{\n    let user = req.query;\n    console.log(user)\n    if(user.usename == 'admin' && user.password == 123456){\n        token = md5(user.usename+user.password)\n        res.send({'msg':'S','token':md5(user.usename+user.password)});\n    }else{\n        res.send({'msg':'F'})\n    }\n});\n\n/**\n * 获取info信息的get */\napp.get('/getInfos', (req, res)=>{\n\t//对前端请求进行token验证\n    let authorization = req.get('Authorization')\n    if(token === authorization){\n        fs.readFile('./data.json','utf8',(err,data)=>{\n            res.send({\"msg\":'S',\"infos\":data})\n        })\n    }else{\n        res.send({\"msg\":'F'})\n    }\n});\n\napp.listen(8080,()=>{\n    console.log('node server is running...');\n})\n")])])]),s("p",[e._v("在开发中陆续导入MD5和fs模块用于token的生成和json文件的读取，用于返回前端的请求。通过exprss模块")]),e._v(" "),s("blockquote",[s("p",[e._v("const express = require('express');\nconst app = express();")])]),e._v(" "),s("p",[e._v("生成app实例用于调用post和get方法。对于用户的登录请求，利用app.post方法接受，并且将用户名和密码经过MD5加密生成token返回给前端；同时利用：")]),e._v(" "),s("blockquote",[s("p",[e._v("app.post('/loginapp',(req,res,next)=>{})")])]),e._v(" "),s("p",[e._v("方法中添加next参数对请求进行拦截处理，实现统计登陆次数的功能。\n对于用户请求数据的接口getInfos，将服务器的json数据读取返回给前端，"),s("strong",[e._v("并且对前端请求进行token验证，验证通过返回数据，验证失败返回失败标识")]),e._v("。\n最终绑定服务器api接口的端口号为8080：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("app.listen(8080,()=>{\n    console.log('node server is running...');\n})\n")])])]),s("h2",{attrs:{id:"_4-开启api服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-开启api服务"}},[e._v("#")]),e._v(" 4.开启api服务")]),e._v(" "),s("p",[e._v("在当前目录打开终端输入：\n启动服务")]),e._v(" "),s("blockquote",[s("p",[e._v("node app.js")])]),e._v(" "),s("p",[e._v("终端中出现    **node server is running...**说明服务启动成功！")]),e._v(" "),s("p",[e._v("欢迎大家关注本人的微信公众号，微信公众号将不定期发送相应学习文章和教程")]),e._v(" "),s("p",[s("strong",[s("center",[e._v("微信号：chiyizao")])],1),e._v(" "),s("center",[e._v("或者微信公众号搜索：")]),s("center",[e._v("迟亦早")]),e._v(" "),s("strong",[s("center",[e._v("二维码")])],1),e._v(" "),s("center",[s("img",{staticStyle:{height:"250px",width:"250px"},attrs:{src:"/vxgzhcode.jpg"}})])],1)])}),[],!1,null,null,null);n.default=r.exports}}]);